<div>
  <h1>Service Objects & Gropus</h1>

  <div class="mt-3 mb-3">
    <div class="form-row pb-2">
      <span class="col-form-label mr-2">Tier (VRF)</span>
      <select
        name="vrf"
        class="form-control col-md-3 mr-1"
        [(ngModel)]="currentVrf"
        (ngModelChange)="getVrfObjects(currentVrf)"
        [disabled]="dirty"
      >
        <option *ngFor="let vrf of vrfs" [ngValue]="vrf">{{ vrf.name }}</option>
      </select>

      <div class="button-group btn-group-sm ml-auto">
        <button
          type="button"
          class="btn btn-warning mr-1"
          aria-label="Save Network Objects/Groups"
          (click)="saveAll()"
          [hidden]="!dirty"
        >
          <fa name="save"></fa>
          Save Changes to Current Tier (VRF)
        </button>
        <button
          type="button"
          class="btn btn-danger mr-1"
          aria-label="Clear Changes"
          (click)="getVrfs()"
          [hidden]="!dirty"
        >
          <fa name="trash"></fa>
          Clear Changes to Current TIer (VRF)
        </button>
      </div>
    </div>
  </div>

  <ul class="nav nav-tabs">
    <li class="nav-item" (click)="navIndex = 0">
      <a class="nav-link" [ngClass]="{ active: navIndex == 0 }"
        >Service Object</a
      >
    </li>
    <li class="nav-item" (click)="navIndex = 1">
      <a class="nav-link" [ngClass]="{ active: navIndex == 1 }"
        >Service Object Groups</a
      >
    </li>
  </ul>

  <div *ngIf="navIndex == 0">
    <div class="btn-group-sm mb-2 mt-3 pull-right" role="group">
      <button
        type="button"
        class="btn btn-success"
        (click)="createServiceObject()"
        aria-label="Create Service Object"
      >
        <fa name="plus"></fa>
        Create Service Object
      </button>
    </div>

    <table class="table table-striped">
      <thead>
        <tr>
          <th scope="col">Name</th>
          <th scope="col">Type</th>
          <th scope="col">Source Port</th>
          <th scope="col">Destination Port</th>
          <th scope="col"></th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let serviceObject of serviceObjects">
          <td>
            <span>{{ serviceObject.Name }}</span>
          </td>
          <td>
            <span>{{ serviceObject.Type }}</span>
          </td>
          <td>
            <span>{{ serviceObject.SourcePort }}</span>
          </td>
          <td>
            <span>{{ serviceObject.DestinationPort }}</span>
          </td>
          <td class="item-actions">
            <fa
              name="pencil"
              (click)="editServiceObject(serviceObject)"
              aria-label="Edit Service Object"
            >
            </fa>
            <fa name="trash" (click)="deleteServiceObject(serviceObject)"> </fa>
          </td>
        </tr>
        <tr *ngIf="!serviceObjects?.length" class="text-center">
          <td colspan="5">No Service Objects in this Tier (VRF)</td>
        </tr>
      </tbody>
    </table>
  </div>

  <div *ngIf="navIndex == 1">
    <div class="btn-group-sm mb-2 mt-3 pull-right" role="group">
      <button
        type="button"
        class="btn btn-success"
        (click)="createServiceObjectGroup()"
        aria-label="Service Object Groups"
      >
        <fa name="plus"></fa>
        Create Service Object Group
      </button>
    </div>

    <table class="table table-striped">
      <thead>
        <tr>
          <th scope="col">Name</th>
          <th scope="col">Type</th>
          <th scope="col">Members</th>
          <th scope="col"></th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let serviceObjectGroup of serviceObjectGroups">
          <td>
            <span>{{ serviceObjectGroup.Name }}</span>
          </td>
          <td>
            <span>{{ serviceObjectGroup.Type }}</span>
          </td>
          <td>
            <span>{{ serviceObjectGroup.ServiceObjects.length }}</span>
          </td>
          <td class="item-actions">
            <fa
              name="pencil"
              (click)="editServiceObjectGroup(serviceObjectGroup)"
              aria-label="Edit Service Object Group"
            >
            </fa>
            <fa
              name="trash"
              (click)="deleteServiceObjectGroup(serviceObjectGroup)"
            >
            </fa>
          </td>
        </tr>
        <tr *ngIf="!serviceObjectGroups?.length" class="text-center">
          <td colspan="4">No Service Object Groups in this Tier (VRF)</td>
        </tr>
      </tbody>
    </table>
  </div>
</div>

<div class="pull-right" *ngIf="currentVrf">
  <app-import-export
    [exportObject]="exportServiceObjectConfig()"
    exportFileName="serviceObjects-{{ currentVrf.name }}"
    disableCsv="true"
    (import)="importServiceObjectConfig($event)"
  ></app-import-export>
</div>

<app-service-object-group-modal></app-service-object-group-modal>
<app-service-object-modal></app-service-object-modal>
