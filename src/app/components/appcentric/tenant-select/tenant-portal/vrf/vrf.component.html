<ng-container *ngIf="!isLoading; else loading">
  <div *ngIf="tenant?.routeControlStatus === 'ACTIVE' && tenant?.routeControlRejectionReason" class="alert alert-warning mb-3" role="alert">
    <div style="display: flex; align-items: center; justify-content: space-between; gap: 12px">
      <div>Your last Route Control request was rejected.</div>
      <div>
        <a href="javascript:void(0)" (click)="openRejectionModal()" style="text-decoration: underline">View Rejection Reason</a>
      </div>
    </div>
    <div class="mt-2 text-muted" style="font-size: 0.85rem">Please review and resubmit a new request.</div>
  </div>
  <section class="btn-toolbar" role="toolbar">
    <button *ngIf="tenant.routeControlStatus !== 'PENDING'" type="button" class="btn btn-primary" (click)="createRouteControlRequest()">
      <fa-icon class="icon" [icon]="['fas', 'paper-plane']"></fa-icon>
      <span>Deploy Route Changes</span>
    </button>
    <button *ngIf="tenant.routeControlStatus === 'PENDING'" type="button" class="btn btn-danger" (click)="cancelRouteControlRequest()">
      <fa-icon class="icon" [icon]="['fas', 'times']"></fa-icon>
      <span>Cancel Route Control Request</span>
    </button>
  </section>
  <app-table
    [config]="config"
    [data]="vrfs"
    (clearResults)="getVrfs($event)"
    (searchParams)="getVrfs($event)"
    [searchColumns]="searchColumns"
    [(itemsPerPage)]="perPage"
    (tableEvent)="onTableEvent($event)"
  ></app-table>
  <section class="btn-toolbar" role="toolbar">
    <app-import-export [exportObject]="vrfs" exportFileName="vrfs" [disableJson]="false" (import)="importVrfs($event)"></app-import-export>
  </section>
</ng-container>

<ng-template #actionsTemplate let-vrf="datum">
  <section class="table__actions">
    <app-icon-button
      *ngIf="applicationMode === ApplicationMode.TENANTV2"
      icon="cog"
      label="Route Control"
      (handleClick)="navigateToRouteConfig(vrf.id)"
    ></app-icon-button>
    <app-icon-button
      *ngIf="!vrf?.deletedAt"
      icon="edit"
      label="Edit VRF"
      (handleClick)="openVrfModal(ModalMode.Edit, vrf)"
    ></app-icon-button>

    <app-icon-button
      *ngIf="vrf?.deletedAt"
      icon="undo"
      label="Restore VRF"
      type="success"
      (handleClick)="restoreVrf(vrf)"
    ></app-icon-button>

    <app-icon-button
      *ngIf="!vrf?.provisionedAt"
      icon="delete"
      label="Soft-Delete/Delete VRF"
      [type]="vrf?.deletedAt ? 'danger' : 'default'"
      (handleClick)="deleteVrf(vrf)"
    ></app-icon-button>

    <!-- <app-icon-button
      *ngIf="vrf?.provisionedAt"
      icon="download"
      label="Deprovision VRF"
      type="danger"
      (handleClick)="deprovisionVrf(vrf)"
    ></app-icon-button> -->

    <app-icon-button icon="expand" label="Expand Row" (click)="expandedRow = expandedRow === vrf ? null : vrf"></app-icon-button>
  </section>
</ng-template>

<ng-template #loading>
  <fa-icon class="icon" [icon]="['fas', 'spinner']" [spin]="true"></fa-icon>
</ng-template>

<app-vrf-modal [tenantId]="tenantId"></app-vrf-modal>
<app-yes-no-modal></app-yes-no-modal>
