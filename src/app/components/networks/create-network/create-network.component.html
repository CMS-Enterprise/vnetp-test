<!--TODO: Form can currently be submitted with invalid CIDR format address-->

<h4>Create Network</h4>

<div class="offset-1 col-md-10">
  <div>
    <form
      name="networkForm"
      class="form"
      (ngSubmit)="form.form.valid && createNetwork()"
      #form="ngForm"
      novalidate
    >
      <div class="form-row">
        <div class="form-group col-md-6">
          <label for="name">Network Name</label>
          <input
            name="name"
            appIsAlphanumeric
            type="text"
            class="form-control"
            aria-label="Network Name"
            #name="ngModel"
            [(ngModel)]="network.Name"
            (ngModelChange)="calculateNetwork()"
            [ngClass]="{ 'is-invalid': form.submitted && name.invalid }"
            required
          />
        </div>
        <div class="form-group col-md-4">
          <label for="protocol">Protocol</label>
          <select class="form-control" id="protocol" disabled>
            <option selected>IPv4</option>
          </select>
        </div>
      </div>
      <div class="form-row">
        <div class="col-md-2 mb-3">
          <label for="inputAddress">Network Address</label>
          <input
            name="networkAddress"
            type="text"
            class="form-control"
            aria-label="Network Address"
            #networkAddress="ngModel"
            [(ngModel)]="cidrAddress"
            (ngModelChange)="calculateNetwork()"
            [ngClass]="{
              'is-invalid': form.submitted && networkAddress.invalid
            }"
            [dropSpecialCharacters]="false"
            mask="099.099.099.099/09"
            required
          />
          <div *ngIf="subnetExists" class="alert alert-danger">
            <div>Subnet/Name already in use.</div>
          </div>
        </div>
        <div class="form-group col-md-2">
          <label for="subnetMask">Subnet Mask</label>
          <input
            type="text"
            readonly
            class="form-control-plaintext"
            id="subnetMask"
            value="{{ this.network.SubnetMask }}"
          />
        </div>
        <div class="form-group col-md-2">
          <label for="usableAddressSpace">Usable Addresses</label>
          <input
            type="text"
            readonly
            class="form-control-plaintext"
            id="usableAddressSpace"
            value="{{ usableRange }}"
          />
        </div>
        <div class="form-group col-md-2">
          <label for="gateway">Gateway</label>
          <input
            type="text"
            readonly
            class="form-control-plaintext"
            id="gateway"
            value="{{ gateway }}"        
          />      
        </div>
        <div class="form-group col-md-2">
          <label for="subnetMask">Total Addresses</label>
          <input
            type="text"
            readonly
            class="form-control-plaintext"
            id="subnetMask"
            value="{{ rangeSize }}"
          />
        </div>
      </div>
      <div class="form-row">
        <div class="form-group col-md-1">
          <label for="vlanId">VLAN ID</label>
          <input
            name="vlanId"
            type="number"
            class="form-control"
            aria-label="VLAN Id"
            #vlanId="ngModel"
            [(ngModel)]="network.VlanId"
            [ngClass]="{ 'is-invalid': form.submitted && vlanId.invalid }"
            required
          />
        </div>
      </div>
      <div class="btn-group">
        <button class="btn btn-success" aria-label="Save" disabled>
          Save
        </button>
        <button
          class="btn btn-danger"
          (click)="createNetwork()"
          aria-label="Deploy"
          type="submit"
        >
          Deploy
        </button>
      </div>
    </form>
  </div>
</div>