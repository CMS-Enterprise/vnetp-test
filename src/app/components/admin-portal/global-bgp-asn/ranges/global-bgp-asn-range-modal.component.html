<ngx-smart-modal #globalBgpAsnRangeModal identifier="globalBgpAsnRangeModal" [dismissable]="false" (onOpen)="getData()" (onClose)="reset()">
  <header class="modal-header">
    <h4 class="modal-title">{{ mode === 'Create' ? 'Create BGP ASN Range' : 'Edit BGP ASN Range' }}</h4>
  </header>

  <form [formGroup]="form" class="form">
    <div class="form-group">
      <label>Name</label>
      <input type="text" class="form-control" formControlName="name" />
      <div class="text-danger small" *ngIf="form.get('name')?.touched && form.get('name')?.invalid">Name is required.</div>
    </div>

    <div class="form-group">
      <label>Environment</label>
      <select class="form-control" formControlName="environmentId">
        <option [ngValue]="null" disabled>Select environment</option>
        <option *ngFor="let env of environments" [ngValue]="env.id">{{ env.name }}</option>
      </select>
    </div>

    <div class="form-group">
      <label>Display Format</label>
      <div class="form-check">
        <input
          class="form-check-input"
          type="radio"
          name="displayFormat"
          id="formatAsplain"
          [checked]="displayFormat === 'asplain'"
          (change)="displayFormat = 'asplain'; onFormatChange()"
        />
        <label class="form-check-label" for="formatAsplain">ASPlain</label>
      </div>
      <div class="form-check">
        <input
          class="form-check-input"
          type="radio"
          name="displayFormat"
          id="formatAsdot"
          [checked]="displayFormat === 'asdot'"
          (change)="displayFormat = 'asdot'; onFormatChange()"
        />
        <label class="form-check-label" for="formatAsdot">ASdot</label>
      </div>
    </div>

    <div class="form-group">
      <label>Start ASN</label>
      <input
        *ngIf="displayFormat === 'asplain'"
        type="number"
        class="form-control"
        formControlName="startAsPlain"
        placeholder="e.g. 65536"
        min="65536"
        max="4294967294"
      />
      <input
        *ngIf="displayFormat === 'asdot'"
        type="text"
        class="form-control"
        formControlName="startAsDot"
        placeholder="e.g. 1.0"
      />
      <div class="text-danger small" *ngIf="displayFormat === 'asplain' && startAsPlainCtrl?.touched && startAsPlainCtrl?.invalid">
        <div *ngIf="startAsPlainCtrl.errors?.required">Start ASN is required.</div>
        <div *ngIf="startAsPlainCtrl.errors?.invalidFormat">Start ASN must be a valid number.</div>
        <div *ngIf="startAsPlainCtrl.errors?.min">Start ASN must be ≥ 65536.</div>
        <div *ngIf="startAsPlainCtrl.errors?.max">Start ASN exceeds allowed private 4-byte range.</div>
      </div>
      <div class="text-danger small" *ngIf="displayFormat === 'asdot' && startAsDotCtrl?.touched && startAsDotCtrl?.invalid">
        <div *ngIf="startAsDotCtrl.errors?.required">Start ASN is required.</div>
        <div *ngIf="startAsDotCtrl.errors?.invalidFormat">Start ASN must be in ASdot format (e.g. 1.0).</div>
        <div *ngIf="startAsDotCtrl.errors?.min">Start ASN must be ≥ 65536.</div>
        <div *ngIf="startAsDotCtrl.errors?.max">Start ASN exceeds allowed private 4-byte range.</div>
      </div>
    </div>

    <div class="form-group">
      <label>End ASN</label>
      <input
        *ngIf="displayFormat === 'asplain'"
        type="number"
        class="form-control"
        formControlName="endAsPlain"
        placeholder="e.g. 65636"
        min="65536"
        max="4294967294"
      />
      <input
        *ngIf="displayFormat === 'asdot'"
        type="text"
        class="form-control"
        formControlName="endAsDot"
        placeholder="e.g. 1.100"
      />
      <div class="text-danger small" *ngIf="displayFormat === 'asplain' && endAsPlainCtrl?.touched && endAsPlainCtrl?.invalid">
        <div *ngIf="endAsPlainCtrl.errors?.required">End ASN is required.</div>
        <div *ngIf="endAsPlainCtrl.errors?.invalidFormat">End ASN must be a valid number.</div>
        <div *ngIf="endAsPlainCtrl.errors?.min">End ASN must be ≥ 65536.</div>
        <div *ngIf="endAsPlainCtrl.errors?.minRange">End ASN must be ≥ Start ASN.</div>
        <div *ngIf="endAsPlainCtrl.errors?.max">End ASN exceeds allowed private 4-byte range.</div>
      </div>
      <div class="text-danger small" *ngIf="displayFormat === 'asdot' && endAsDotCtrl?.touched && endAsDotCtrl?.invalid">
        <div *ngIf="endAsDotCtrl.errors?.required">End ASN is required.</div>
        <div *ngIf="endAsDotCtrl.errors?.invalidFormat">End ASN must be in ASdot format (e.g. 1.100).</div>
        <div *ngIf="endAsDotCtrl.errors?.min">End ASN must be ≥ 65536.</div>
        <div *ngIf="endAsDotCtrl.errors?.minRange">End ASN must be ≥ Start ASN.</div>
        <div *ngIf="endAsDotCtrl.errors?.max">End ASN exceeds allowed private 4-byte range.</div>
      </div>
    </div>

    <div class="form-group">
      <label>Description</label>
      <textarea class="form-control" rows="3" formControlName="description"></textarea>
    </div>

    <div class="d-flex justify-content-end gap-2">
      <button type="button" class="btn btn-link" (click)="close()">Cancel</button>
      <button type="button" class="btn btn-primary" (click)="save()" [disabled]="isFormInvalid()">Save</button>
    </div>
  </form>
</ngx-smart-modal>
