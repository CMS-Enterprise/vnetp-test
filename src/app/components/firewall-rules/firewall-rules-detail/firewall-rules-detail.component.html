<div>
    <h4 aria-label="Tier Name">{{ TierName }} Tier - {{ FirewallRuleGroup?.name }} Firewall Rules</h4>

  <div class="btn-toolbar mb-2 pull-right" role="toolbar">
    <div class="btn-group-sm" role="group">
      <button
        type="button"
        class="btn btn-success mr-1"
        (click)="createFirewallRule()"
        aria-label="Add Firewall Rule"
      >
        <fa name="plus"></fa>
        Add Firewall Rule
      </button>
      <button
        type="button"
        class="btn btn-info mr-1"
        (click)="refresh()"
        aria-label="Refresh Firewall Rules"
        *ngIf="!dirty"
      >
        <fa name="refresh"></fa>
        Refresh
      </button>
    </div>
  </div>

  <table class="table table-striped">
    <thead>
      <tr>
        <th scope="col">Name</th>
        <th scope="col">Action</th>
        <th scope="col">Protocol</th>
        <th scope="col">Direction</th>
        <th scope="col">Source Address</th>
        <th scope="col">Source Service</th>
        <th scope="col">Destination Address</th>
        <th scope="col">Destination Service</th>
        <th scope="col">Log</th>
        <th scope="col">Rule Index</th>
        <th></th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let firewallRule of firewallRules | paginate: { itemsPerPage: perPage, currentPage: currentFirewallRulePage }">
        <td>
          <p>{{ firewallRule?.name }}</p>
        </td>
        <td>
          <p>{{ firewallRule?.action }}</p>
        </td>
        <td>
          <p>{{ firewallRule?.protocol }}</p>
        </td>
        <td>
          <p>{{ firewallRule?.direction }}</p>
        </td>
        <td>
          <p *ngIf="firewallRule.sourceAddressType === 'IpAddress'" aria-label="Source IP">
            {{ firewallRule?.sourceIpAddress }}
          </p>
          <p
            *ngIf="firewallRule.sourceAddressType === 'NetworkObject'"
            aria-label="Source Network Object"
          >
            {{ firewallRule?.sourceNetworkObjectId | resolve: getNetworkObjectName }} (Object)
          </p>
          <p
            *ngIf="firewallRule.sourceAddressType === 'NetworkObjectGroup'"
            aria-label="Source Network Object Group"
          >
            {{ firewallRule?.sourceNetworkObjectGroupId | resolve: getNetworkObjectGroupName }} (Object Group)
          </p>
        </td>
        <td>
          <p *ngIf="firewallRule.sourceServiceType === 'Port'" aria-label="Source Ports">
            {{ firewallRule?.sourcePorts }}
          </p>
          <p
            *ngIf="firewallRule.sourceServiceType === 'ServiceObject'"
            aria-label="Source Service Object"
          >
            {{ firewallRule?.sourceServiceObjectId | resolve: getServiceObjectName  }} (Object)
          </p>
          <p
            *ngIf="firewallRule.sourceServiceType === 'ServiceObjectGroup'"
            aria-label="Source Service Object Group"
          >
            {{ firewallRule?.sourceServiceObjectGroupId | resolve: getServiceObjectGroupName }} (Object Group)
          </p>
        </td>
        <td>
          <p *ngIf="firewallRule.destinationAddressType === 'IpAddress'" aria-label="Destination IP">
            {{ firewallRule?.destinationIpAddress }}
          </p>
          <p
          *ngIf="firewallRule.destinationAddressType === 'NetworkObject'"
          aria-label="Destination Network Object"
          >
            {{ firewallRule?.destinationNetworkObjectId | resolve: getNetworkObjectName }} (Object)
          </p>
          <p
            *ngIf="firewallRule.destinationAddressType === 'NetworkObjectGroup'"
            aria-label="Destination Network Object Group"
          >
            {{ firewallRule?.destinationNetworkObjectGroupId | resolve: getNetworkObjectGroupName }} (Object Group)
          </p>
        </td>
        <td>
          <p
          *ngIf="firewallRule.destinationServiceType === 'Port'"
            aria-label="Destination Ports"
          >
            {{ firewallRule?.destinationPorts }}
          </p>
          <p
            *ngIf="firewallRule.destinationServiceType === 'ServiceObject'"
            aria-label="Destination Service Object"
          >
            {{ firewallRule?.destinationServiceObjectId | resolve: getServiceObjectName }} (Object)
          </p>
          <p
          *ngIf="firewallRule.destinationServiceType === 'ServiceObjectGroup'"
          aria-label="Destination Service Object Group"
          >
            {{ firewallRule?.destinationServiceObjectGroupId | resolve: getServiceObjectGroupName }} (Object Group)
          </p>
        </td>
        <td>
          <p>{{ firewallRule?.logging }}</p>
        </td>
        <td>
          <span>{{ firewallRule?.ruleIndex }}</span>
        </td>
        <td class="item-actions">
          <fa name="pencil" *ngIf="!firewallRule.deletedAt" (click)="openFirewallRuleModal('Edit', firewallRule)"> </fa>
        <fa
          name="undo"
          *ngIf="firewallRule?.deletedAt"
          class="fg-success"
          (click)="restoreFirewallRule(firewallRule)"
          aria-label="Restore Network Object Group"
        ></fa>
        <fa
          name="trash"
          [ngClass]="{ 'fg-danger': firewallRule.deletedAt }"
          (click)="deleteFirewallRule(firewallRule)"
          aria-label="Soft-Delete/Delete Firewall Rule"
        ></fa>
        <!-- <fa name="copy" (click)="duplicateFirewallRule(firewallRule)"></fa> -->
        </td>
      </tr>
      <tr *ngIf="firewallRules?.length === 0" class="text-center">
        <td colspan="10">No Firewall Rules</td>
      </tr>
    </tbody>
  </table>
  <pagination-controls (pageChange)="currentFirewallRulePage = $event"></pagination-controls>

<div class="btn-toolbar" role="toolbar" aria-label="Entities per page">
  <div class="btn-group mr-2" role="group" aria-label="First group">
    Entities per page
    <button type="button" value="50" (click)="perPage = $event.target.value" class="btn btn-light">50</button>
    <button type="button" value="100" (click)="perPage = $event.target.value" class="btn btn-light">100</button>
    <button type="button" value="200" (click)="perPage = $event.target.value" class="btn btn-light">200</button>
  </div>
</div>

  <div *ngIf="firewallRules?.length" class="btn-toolbar mb-2 pull-right" role="toolbar">
    <div class="btn-group-sm" role="group">
      <app-import-export
        [exportObject]="firewallRules"
        exportFileName="firewallRules-{{ TierName }}-{{ FirewallRuleGroup?.name }}"
        (import)="importFirewallRulesConfig($event)"
        [disableJson]="false"
      ></app-import-export>
    </div>
  </div>
</div>

<app-firewall-rule-modal></app-firewall-rule-modal>
<app-yes-no-modal></app-yes-no-modal>
