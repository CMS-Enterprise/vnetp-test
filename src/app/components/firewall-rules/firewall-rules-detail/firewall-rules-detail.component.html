<div>
    <h4 aria-label="VRF Name">Tier: {{ TierId }} {{ FirewallRuleGroup?.name }} Firewall Rules</h4>

  <div class="btn-toolbar mb-2 pull-right" role="toolbar">
    <div class="btn-group-sm" role="group">
      <button
        type="button"
        class="btn btn-success mr-1"
        (click)="createFirewallRule()"
        aria-label="Add Firewall Rule"
      >
        <fa name="plus"></fa>
        Add Firewall Rule
      </button>

      <app-import-export
        [exportObject]="firewallRules"
        exportFileName="firewallRules-{{ vrf?.name }}-{{ scope == 0 ? 'external' : 'intervrf' }}"
        (import)="insertFirewallRules($event)"
        disableExport="true"
      ></app-import-export>

      <button
        type="button"
        class="btn btn-info mr-1"
        (click)="refresh()"
        aria-label="Refresh Firewall Rules"
        *ngIf="!dirty"
      >
        <fa name="refresh"></fa>
        Refresh
      </button>
    </div>
  </div>

  <table class="table table-striped">
    <thead>
      <tr>
        <th scope="col">Name</th>
        <th scope="col">Action</th>
        <th scope="col">Protocol</th>
        <th scope="col">Direction</th>
        <th scope="col">Source Address</th>
        <th scope="col">Source Service</th>
        <th scope="col">Destination Address</th>
        <th scope="col">Destination Service</th>
        <th scope="col">Log</th>
        <th scope="col">Rule Index</th>
        <th></th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let firewallRule of firewallRules">
        <td>
          <p>{{ firewallRule?.name }}</p>
        </td>
        <td>
          <p>{{ firewallRule?.action }}</p>
        </td>
        <td>
          <p>{{ firewallRule?.protocol }}</p>
        </td>
        <td>
          <p>{{ firewallRule?.direction }}</p>
        </td>
        <td>
          <p *ngIf="firewallRule.sourceAddressType === 'IpAddress'" aria-label="Source IP">
            {{ firewallRule?.sourceIpAddress }}
          </p>
          <p
            *ngIf="firewallRule.sourceAddressType === 'NetworkObject'"
            aria-label="Source Network Object"
          >
            {{ firewallRule?.sourceNetworkObject }} (Object)
          </p>
          <p
            *ngIf="firewallRule.sourceAddressType === 'NetworkObjectGroup'"
            aria-label="Source Network Object Group"
          >
            {{ firewallRule?.sourceNetworkObjectGroup }} (Object Group)
          </p>
        </td>
        <td>
          <p *ngIf="firewallRule.sourceServiceType === 'Port'" aria-label="Source Ports">
            {{ firewallRule?.sourcePorts }}
          </p>
          <p
            *ngIf="firewallRule.sourceServiceType === 'ServiceObject'"
            aria-label="Source Service Object"
          >
            {{ firewallRule?.sourceServiceObject }} (Object)
          </p>
          <p
            *ngIf="firewallRule.sourceServiceType === 'ServiceObjectGroup'"
            aria-label="Source Service Object Group"
          >
            {{ firewallRule?.sourceServiceObjectGroup }} (Object Group)
          </p>
        </td>
        <td>
          <p *ngIf="firewallRule.sourceAddressType === 'IpAddress'" aria-label="Destination IP">
            {{ firewallRule?.destinationIpAddress }}
          </p>
          <p
          *ngIf="firewallRule.sourceAddressType === 'NetworkObject'"
          aria-label="Destination Network Object"
          >
            {{ firewallRule?.destinationNetworkObject }} (Object)
          </p>
          <p
            *ngIf="firewallRule.sourceAddressType === 'NetworkObjectGroup'"
            aria-label="Destination Network Object Group"
          >
            {{ firewallRule?.destinationNetworkObjectGroup }} (Object Group)
          </p>
        </td>
        <td>
          <p
          *ngIf="firewallRule.destinationServiceType === 'Port'"
            aria-label="Destination Ports"
          >
            {{ firewallRule?.destinationPorts }}
          </p>
          <p
            *ngIf="firewallRule.destinationServiceType === 'ServiceObject'"
            aria-label="Destination Service Object"
          >
            {{ firewallRule?.destinationServiceObject }} (Object)
          </p>
          <p
          *ngIf="firewallRule.destinationServiceType === 'ServiceObjectGroup'"
          aria-label="Destination Service Object Group"
          >
            {{ firewallRule?.destinationServiceObjectGroup }} (Object Group)
          </p>
        </td>
        <td>
          <p>{{ firewallRule?.logging }}</p>
        </td>
        <td>
          <span>{{ firewallRule?.ruleIndex }}</span>
        </td>
        <td class="item-actions">
          <fa name="pencil" (click)="editFirewallRule(firewallRule)"> </fa>
          <!-- <fa name="chevron-up" (click)="moveFirewallRule(-1, firewallRule)">
          </fa>
          <fa name="chevron-down" (click)="moveFirewallRule(1, firewallRule)">
          </fa> -->
          <fa name="trash" (click)="deleteFirewallRule(firewallRule)"> </fa>
          <!-- <fa name="copy" (click)="duplicateFirewallRule(firewallRule)"></fa> -->
        </td>
      </tr>
      <tr *ngIf="firewallRules?.length === 0" class="text-center">
        <td colspan="10">No Firewall Rules</td>
      </tr>
    </tbody>
  </table>

  <div *ngIf="firewallRules?.length" class="btn-toolbar mb-2 pull-right" role="toolbar">
    <div class="btn-group-sm" role="group">
      <app-import-export
        [exportObject]="firewallRules"
        exportFileName="firewallRules-{{ vrf?.name }}-{{ scope == 0 ? 'external' : 'intervrf' }}"
        (import)="insertFirewallRules($event)"
        disableImport="true"
      ></app-import-export>
    </div>
  </div>
</div>

<app-firewall-rule-modal></app-firewall-rule-modal>
