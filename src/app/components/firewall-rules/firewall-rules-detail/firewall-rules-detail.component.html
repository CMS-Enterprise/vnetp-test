<div>
    <h1 *ngIf="scope == 0 || scope == 1" aria-label="VRF Name">VRF: {{ vrf?.name }}</h1>

  <div class="btn-toolbar mb-2 pull-right" role="toolbar">
    <div class="btn-group-sm" role="group">
      <button
        type="button"
        class="btn btn-warning mr-1"
        (click)="updateFirewallRules()"
        aria-label="Update Firewall Rules"
        *ngIf="dirty"
      >
        <fa name="save"></fa>
        Save Changes
      </button>

      <button
        type="button"
        class="btn btn-success mr-1"
        (click)="createFirewallRule()"
        aria-label="Add Firewall Rule"
      >
        <fa name="plus"></fa>
        Add Firewall Rule
      </button>

      <app-import-export
        [exportObject]="firewallRules"
        exportFileName="firewallRules-{{ subnet.name }}-{{
          subnet.vrf_group_name
        }}"
        (import)="insertFirewallRules($event)"
        disableExport="true"
      ></app-import-export>

      <button
        type="button"
        class="btn btn-info mr-1"
        (click)="refresh()"
        aria-label="Refresh Firewall Rules"
        *ngIf="!dirty"
      >
        <fa name="refresh"></fa>
        Refresh
      </button>
    </div>
  </div>

  <table class="table table-striped">
    <thead>
      <tr>
        <th scope="col">Name</th>
        <th scope="col">Action</th>
        <th scope="col">Protocol</th>
        <th scope="col">Direction</th>
        <th scope="col">Source Address</th>
        <th scope="col">Source Service</th>
        <th scope="col">Destination Address</th>
        <th scope="col">Destination Service</th>
        <th scope="col">Log</th>
        <th></th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let firewallRule of firewallRules">
        <td>
          <p>{{ firewallRule.Name }}</p>
        </td>
        <td>
          <p>{{ firewallRule.Action }}</p>
        </td>
        <td>
          <p>{{ firewallRule.Protocol }}</p>
        </td>
        <td>
          <p>{{ firewallRule.Direction }}</p>
        </td>
        <td>
          <p *ngIf="firewallRule.SourceIP" aria-label="Source IP">
            {{ firewallRule.SourceIP }}
          </p>
          <p
            *ngIf="firewallRule.SourceNetworkObject"
            aria-label="Source Network Object"
          >
            {{ firewallRule.SourceNetworkObject }} (Object)
          </p>
          <p
            *ngIf="firewallRule.SourceNetworkObjectGroup"
            aria-label="Source Network Object Group"
          >
            {{ firewallRule.SourceNetworkObjectGroup }} (Object Group)
          </p>
        </td>
        <td>
          <p *ngIf="firewallRule.SourcePorts" aria-label="Source Ports">
            {{ firewallRule.SourcePorts }}
          </p>
          <p
            *ngIf="firewallRule.SourceServiceObject"
            aria-label="Source Service Object"
          >
            {{ firewallRule.SourceServiceObject }} (Object)
          </p>
          <p
            *ngIf="firewallRule.SourceServiceObjectGroup"
            aria-label="Source Service Object Group"
          >
            {{ firewallRule.SourceServiceObjectGroup }} (Object Group)
          </p>
        </td>
        <td>
          <p *ngIf="firewallRule.DestinationIP" aria-label="Destination IP">
            {{ firewallRule.DestinationIP }}
          </p>
          <p
            *ngIf="firewallRule.DestinationNetworkObject"
            aria-label="Destination Network Object"
          >
            {{ firewallRule.DestinationNetworkObject }} (Object)
          </p>
          <p
            *ngIf="firewallRule.DestinationNetworkObjectGroup"
            aria-label="Destination Network Object Group"
          >
            {{ firewallRule.DestinationNetworkObjectGroup }} (Object Group)
          </p>
        </td>
        <td>
          <p
            *ngIf="firewallRule.DestinationPorts"
            aria-label="Destination Ports"
          >
            {{ firewallRule.DestinationPorts }}
          </p>
          <p
            *ngIf="firewallRule.DestinationServiceObject"
            aria-label="Destination Service Object"
          >
            {{ firewallRule.DestinationServiceObject }} (Object)
          </p>
          <p
            *ngIf="firewallRule.DestinationServiceObjectGroup"
            aria-label="Destination Service Object Group"
          >
            {{ firewallRule.DestinationServiceObjectGroup }} (Object Group)
          </p>
        </td>
        <td>
          <p>{{ firewallRule.Log }}</p>
        </td>
        <td class="item-actions">
          <fa name="pencil" (click)="editFirewallRule(firewallRule)"> </fa>
          <fa name="chevron-up" (click)="moveFirewallRule(-1, firewallRule)">
          </fa>
          <fa name="chevron-down" (click)="moveFirewallRule(1, firewallRule)">
          </fa>
          <fa name="trash" (click)="deleteFirewallRule(firewallRule)"> </fa>
          <fa name="copy" (click)="duplicateFirewallRule(firewallRule)"></fa>
        </td>
      </tr>
      <tr *ngIf="firewallRules?.length === 0" class="text-center">
        <td colspan="10">No Firewall Rules</td>
      </tr>
    </tbody>
  </table>

  <div *ngIf="firewallRules?.length" class="btn-toolbar mb-2 pull-right" role="toolbar">
    <div class="btn-group-sm" role="group">
      <app-import-export
        [exportObject]="firewallRules"
        exportFileName="firewallRules-{{ subnet.name }}-{{
          subnet.vrf_group_name
        }}"
        (import)="insertFirewallRules($event)"
        disableImport="true"
      ></app-import-export>
    </div>
  </div>
</div>

<app-firewall-rule-modal></app-firewall-rule-modal>
