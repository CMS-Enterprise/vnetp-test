<ngx-smart-modal
  #internalRouteModal
  [dismissable]="false"
  customClass="medium-modal"
  identifier="internalRouteModal"
  (onOpen)="getData()"
  (onClose)="reset()"
>
  <header class="modal-header">
    <h4 class="modal-title">Internal Routes</h4>
  </header>
  <form [formGroup]="form" (ngSubmit)="save()">
    <div class="modal-body">
      <div class="form-group" *ngIf="applicationMode === 'netcentric'">
        <mat-form-field appearance="outline" class="w-100">
          <mat-label>Subnet</mat-label>
          <mat-select formControlName="netcentricSubnetId" aria-label="Netcentric Subnet">
            <mat-option *ngFor="let subnet of availableNetcentricSubnets" [value]="subnet.id">
              {{ subnet.name }} - {{ subnet.description }} ({{ subnet.network }}, {{ subnet.gateway }}, VLAN: {{ subnet.vlan?.name }}, Tier:
              {{ subnet.tier?.name }}, Shared: {{ subnet.sharedBetweenVrfs ? 'Yes' : 'No' }})
            </mat-option>
          </mat-select>
          <mat-error *ngIf="submitted && f.netcentricSubnetId.errors">
            <ng-container *ngIf="f.netcentricSubnetId.errors.required">Subnet is required</ng-container>
          </mat-error>
        </mat-form-field>
      </div>

      <div class="form-group" *ngIf="applicationMode === ApplicationMode.APPCENTRIC || applicationMode === ApplicationMode.TENANTV2">
        <label for="appcentricSubnet">Subnet</label>
        <mat-form-field appearance="outline" class="w-100">
          <mat-label>Subnet</mat-label>
          <mat-select id="appcentricSubnet" formControlName="appcentricSubnetId" aria-label="Appcentric Subnet">
            <mat-option
              *ngFor="let subnet of availableAppcentricSubnets"
              [value]="subnet.id"
              [disabled]="!subnet.advertisedExternally"
              [attr.aria-disabled]="!subnet.advertisedExternally"
            >
              <span [matTooltip]="'This subnet is not advertised externally'" [matTooltipDisabled]="subnet.advertisedExternally">
                {{ subnet.name }} - {{ subnet.alias }} - {{ subnet.description }} (Gateway IP: {{ subnet.gatewayIp }}, Treat As Virtual IP
                Address: {{ subnet.treatAsVirtualIpAddress ? 'Yes' : 'No' }}, Primary IP Address:
                {{ subnet.primaryIpAddress ? 'Yes' : 'No' }}, Advertised Externally: {{ subnet.advertisedExternally ? 'Yes' : 'No' }},
                Preferred: {{ subnet.preferred ? 'Yes' : 'No' }}, Shared Between VRFs: {{ subnet.sharedBetweenVrfs ? 'Yes' : 'No' }}, IP
                Data Plane Learning: {{ subnet.ipDataPlaneLearning ? 'Yes' : 'No' }}, Tenant: {{ subnet.tenant?.name }}, Bridge Domain:
                {{ subnet.bridgeDomain.name }})
              </span>
              <span
                *ngIf="!subnet.advertisedExternally"
                aria-label="Not advertised externally"
                style="margin-left: 6px; color: #d32f2f; font-size: 12px; font-weight: 600; display: inline-flex; align-items: center"
              >
                <mat-icon color="warn" style="font-size: 16px; height: 16px; width: 16px; margin-right: 4px">error_outline</mat-icon>
                Not advertised externally
              </span>
            </mat-option>
          </mat-select>
          <mat-error *ngIf="submitted && f.appcentricSubnetId.errors">
            <ng-container *ngIf="f.appcentricSubnetId.errors.required">Subnet is required</ng-container>
          </mat-error>
        </mat-form-field>
      </div>
    </div>

    <footer class="modal-footer">
      <button type="button" mat-button (click)="closeModal()">Cancel</button>
      <button mat-raised-button color="primary" type="submit">
        <fa-icon class="icon" [icon]="['fas', 'save']"></fa-icon>
        <span>Save</span>
      </button>
    </footer>
  </form>
</ngx-smart-modal>
