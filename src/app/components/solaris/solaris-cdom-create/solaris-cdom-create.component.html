<div>
  <form name="CDOMCloneOrCreateForm" class="form" #form="ngForm" novalidate>
    <h1 class="mb-3">CDOM</h1>

    <div class="form-group">
      <label for="inputCDOMName">Server Name</label>
      <input
        name="inputCDOMName"
        aria-label="Input CDOM Name"
        type="text"
        class="form-control"
        placeholder="Name"
        #name="ngModel"
        [(ngModel)]="CDOM.name"
      />
    </div>

    <div class="form-group">
      <label for="cdomClone">Clone Host Resources</label>
      <tooltip [message]="helpText.solarisCdomCloneText"></tooltip>
      <div class="input-group align-items-center">
        <select
          name="cdomClone"
          class="form-control"
          id="cdomClone"
          #cdomClone="ngModel"
          [(ngModel)]="cdomInput"
        >
          <option
            class="list-group-item"
            *ngFor="let cdom of CDOMDeviceArray"
            [ngValue]="cdom"
          >
            {{ cdom.name }}
          </option>
        </select>
        <button class="btn btn-info btn-sm" (click)="cloneCdom()">
          Clone
        </button>
      </div>
    </div>

    <hr />

    <div class="form-row">
      <div class="form-group col-md-4">
        <label for="inputCDOMvCPU">vCPU</label>
        <select
          name="inputCDOMvCPU"
          aria-label="vCPU for CDOM"
          class="form-control"
          #name="ngModel"
          [(ngModel)]="CDOM.vcpu"
        >
          <option></option>
          <option *ngFor="let cpuCount of cpuCountArray" [ngValue]="cpuCount"
            >{{ cpuCount }} vCPU</option
          >
        </select>
      </div>

      <div class="form-group col-md-4">
        <label for="inputCDOMMemory">RAM (GB)</label>
        <select
          name="inputCDOMMemory"
          aria-label="RAM GB"
          class="form-control"
          #name="ngModel"
          [(ngModel)]="CDOM.memory"
        >
          <option></option>
          <option *ngFor="let ramAmount of ramCountArray" [ngValue]="ramAmount"
            >{{ ramAmount }} GB</option
          >
        </select>
      </div>
      <div class="form-group col-md-4">
        <label for="inputCDOMVccports"># VCC Ports</label>
        <tooltip [message]="helpText.solarisCdomVccPortsText"></tooltip>
        <input
          name="inputCDOMVccports"
          aria-label="Number VCC Ports"
          class="form-control"
          #name="ngModel"
          [(ngModel)]="CDOM.vccports"
        />
      </div>
      <!--TODO: Validate ngModel and functionality -->
    </div>

    <hr />

    <div class="form-group">
      <label>vSwitches</label>
      <button
        type="button"
        name="modalVswitch"
        class="btn btn-sm btn-info pull-right mb-2"
        (click)="openVswitchModal()"
      >
        <fa name="plus"></fa>
        Add vSwitch
      </button>
      <table name="vSwitchTable" class="table table-striped">
        <thead>
          <tr>
            <th>vSwitch Name</th>
            <th>Untagged VLAN</th>
            <th>Tagged VLAN(s)</th>
            <th>Net Device</th>
            <th></th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let vsw of CDOM.vsw">
            <td>{{ vsw.vSwitchName }}</td>
            <td>{{ vsw.vlansUntagged }}</td>
            <td>{{ vsw.vlansTagged }}</td>
            <td>{{ vsw.netDevice }}</td>
            <td class="item-actions">
              <fa name="pencil" (click)="editVswitch(vsw)"> </fa>
              <fa name="trash" (click)="deletevSwitch(vsw)"> </fa>
            </td>
          </tr>
          <tr *ngIf="!CDOM.vsw?.length" class="text-center">
            <td colspan="5">No vSwitches</td>
          </tr>
        </tbody>
      </table>
    </div>

    <hr />

    <div class="form-group">
      <div class="form-check form-check-inline">
        <input
          name="alternateVds"
          aria-label="Alternate VDS"
          type="checkbox"
          class="form-check-input"
          #formAlternateVds="ngModel"
          [(ngModel)]="CDOM.alternatevds"
        />
        <label class="form-check-label">Create Alternate VDS</label>
      </div>
    </div>

    <hr />

    <div class="pull-right mb-3">
      <a
        class="btn btn-link"
        aria-label="Cancel"
        routerLink="/solaris/cdom/list"
      >
        Cancel
      </a>
      <button
        class="btn btn-success"
        aria-label="Save"
        (click)="launchCDOMJobs()"
      >
        <fa name="save"></fa>
        Save
      </button>
    </div>
  </form>
</div>

<ngx-smart-modal
  #vswitchModalCdom
  identifier="vswitchModalCdom"
  customClass="'modal-content'"
  [dismissable]="false"
  customClass="medium-modal"
>
  <div class="modal-header">
    <h4 class="modal-title">Add vSwitch</h4>
    <button
      type="button"
      class="close"
      data-dismiss="modal"
      aria-label="Close"
      (click)="vswitchModalCdom.close()"
    ></button>
  </div>

  <div class="modal-body">
    <div class="form-row">
      <div class="form-group col-md-12">
        <label for="inputCDOMvswitch">vSwitch</label>
        <tooltip [message]="helpText.solarisCdomVswitchNameText"></tooltip>
        <input
          name="inputCDOMvswitch"
          aria-label="CDOM vSwitch name"
          class="form-control"
          id="inputCDOMvswitch"
          #formVds="ngModel"
          [(ngModel)]="modalVswitch.vSwitchName"
        />
      </div>
    </div>
    <div class="form-group">
      <label for="unTaggedVlan">Untagged VLAN</label>
      <tooltip [message]="helpText.solarisCdomVswitchUnTaggedVlanText"></tooltip>
      <input
        class="form-control"
        type="number"
        [(ngModel)]="modalVswitch.vlansUntagged"
      />
    </div>

    <div class="form-row">
      <div class="form-group col-md-12">
        <label>Tagged VLANs</label>
        <tooltip [message]="helpText.solarisCdomVswitchTaggedVlanText"></tooltip>
        <div class="input-group align-items-center">
          <input
            class="form-control"
            type="number"
            [(ngModel)]="modalAddTaggedVlan"
          />
          <button
            type="button"
            class="btn btn-sm btn-info"
            [disabled]="!modalAddTaggedVlan"
            (click)="vswitchModalAddTaggedVlan()"
            aria-label="Add VLAN"
          >
            <fa name="plus"></fa>
            Add VLAN
          </button>
        </div>
      </div>
    </div>

    <div class="form-row">
      <table class="table table-striped">
        <thead>
          <tr>
            <th>VLAN ID</th>
            <th></th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let taggedVlan of modalVswitch.vlansTagged">
            <td>{{ taggedVlan }}</td>
            <td class="item-actions">
              <fa
                name="trash"
                (click)="vswitchModalRemoveTaggedVlan(taggedVlan)"
              ></fa>
            </td>
          </tr>
          <tr *ngIf="!modalVswitch.vlansTagged?.length" class="text-center">
            <td colspan="2">No Tagged VLANs</td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="form-group">
      <label>Logical Interface</label>
      <tooltip [message]="helpText.solarisCdomVswitchLogicalInterfaceText"></tooltip>
      <select
        name="vnicDevice"
        class="form-control"
        [(ngModel)]="modalVswitch.netDevice"
      >
        <option></option>
        <option *ngFor="let li of LogicalInterfaces" [ngValue]="li?.Name">
          {{ li.Name }}</option
        >
      </select>
    </div>
  </div>

  <div class="modal-footer">
    <button
      type="button"
      class="btn btn-link"
      data-dismiss="modal"
      (click)="vswitchModalCdom.close()"
    >
      Cancel
    </button>

    <button
      type="button"
      class="btn btn-success"
      data-dismiss="modal"
      (click)="insertVswitch()"
    >
      <fa name="save"></fa>
      Save
    </button>
  </div>
</ngx-smart-modal>


